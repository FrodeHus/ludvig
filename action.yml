name: 'Ludvig by Reothor'
description: 'Scan for secrets and vulnerabilities'
author: Frode Hus
branding:
  color: purple
  icon: eye
inputs:
  path: 
    description: 'Path to scan'
    required: true
    default: '.'
  customRulesPath:
    description: 'Path to custom YARA rules'
    required: false
    default: '-'
outputs:
  result: 
    description: 'Scan results'
runs:
  using: 'docker'
  image: 'docker://reothor/ludvig:latest'
  args:
    - '--custom-rules ${{ inputs.customRulesPath }}'
    - fs
    - ${{ inputs.path }}